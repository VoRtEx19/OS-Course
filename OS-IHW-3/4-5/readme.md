# Индивидуальное домашнее задание №3

#### Студент: Светличный Лев Алексеевич

#### Группа: БПИ225

#### Вариант: 30

## Условие задачи
>**Военная операция.** Темной–темной ночью прапорщики Иванов,
Петров и Нечепорук занимаются хищением военного имущества со
склада родной военной части. Будучи умными людьми и отличниками боевой и строевой подготовки, прапорщики ввели разделение
труда. Иванов многократно выносит имущество со склада и передает его в руки Петрову, который грузит его в грузовик. Нечепорук
стоит на шухере и заодно подсчитывает рыночную стоимость добычи поле погрузки в грузовик очередной партии похищенного.

Требуется разработать клиент–серверное приложение,
моделирующее деятельность прапорщиков.

Каждый прапорщик — отдельный клиент. Сервер используется
для передачи информации о продвижении имущества между прапорщиками.

**Необходимо учесть случайное время выполнения каждым
прапорщиком своей боевой задачи и организовать в программе корректную их синхронизацию.**

## Сценарий решаемой задачи
### 4-5 баллов
Сервер держит один порт - 8080. Он предназнчен для подключения клиентов-поручиков.  

При запуске сервера создаётся склад размера n (передаваемый аргумент при запуске программы) и инициализируется случайными предметами.

После того, как сервер запустился, ожидаются подключения клиентов-садовников. При подключении клиента-поручика создается дочерний поток, которому делегируется работа по обработке нового подключения.

В рамках подключения клиент-поручик отправляет на сервер сериализованную структуру, которая представляет задачу на выполнение. Структура содержит идентификатор поручика (1 для Иванова, 2 для Петрова, 3 для Нечепорука), номер текущего предмета, а также статус:
- 0 для первичной задачи: принятие предмета - со склада для Иванова, от Иванова для Петрова, и т.д.; 
- 1 для вторичной задачи: передача предмета - от Иванова Петрову, от Петрова Нечепоруку, Нечепорук - подсчитывает значение;
- 2 для окончания завершения работы клиента.
Процесс аналогичен описанному в ИДЗ-2.

### 6-10 баллов

### Завершение сервера и клиентов
Завершение выполняется с помощью отправки сигнала `SIGINT` нажатием `Ctrl-C`. Обработчики данного сигнала закрывают все необходимые ресурсы: разделяемую память, сокеты, дожидаются завершения дочерних процессов 

## Формат запуска 
Запуск всех программ можно совершить, выполнив скрипт run.sh (но тогда могут быть текстовые накладки, так что рекомендуется запускать каждую программу в отдельном окне zsh).
Для запуска скрипта:
```console
./run.sh <Storage Capacity>
```
Для запуска программ по отдельности:
### Программы на 4-5 баллов
Запуск сервера:
```console
cc server.c -o server.out
./server.out <Server Address> <Server Port> <Storage Capacity>
```
Запуск поручиков где Name: Ivanov, Petrov, Necheporuk
```console
cc <Name>.c -o <Name>.out
./first_gardener <Server Address> <Server Port> <Working time>
```
### Программы на 6-10 баллов
Запуск сервера:
```console
cc server.c -o server.out
./server.out <Server Address> <Server Port> <Observer Port> <Storage Capacity>
```
Запуск поручиков где Name: Ivanov, Petrov, Necheporuk
```console
cc <Name>.c -o <Name>.out
./first_gardener <Server Address> <Server Port> <Working time>
```
Запуск наблюдателя
```console
./observer <Server address> <Server port>
```
## Критерии на 4-10 баллов
Так как программы на каждую из оценок являются дополнением друг к другу, то программа разделена на 2 версии: 4-5 баллов и 6-10.